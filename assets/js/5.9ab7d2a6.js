(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{141:function(t,e,r){"use strict";r.r(e);var n=r(0),o=Object(n.a)({},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[t._m(0),t._v(" "),r("p",[t._v("今天我们很高兴地宣布一个新的箱子和几个新工具\n在Tokio堆栈中。这代表了许多并行的高潮\n对各种零碎的更新，它们恰好便于降落\n大约在同一时间！简而言之，改进是：")]),t._v(" "),r("ul",[r("li",[t._v("从"),r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v("中提取的新"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("箱子，弃用了\n  ["),r("code",[t._v("tokio_core :: io")]),t._v("]模块。")]),t._v(" "),r("li",[t._v("将"),r("a",{attrs:{href:"https://crates.io/crates/bytes",target:"_blank",rel:"noopener noreferrer"}},[t._v("bytes"),r("OutboundLink")],1),t._v(" crate引入"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("，允许抽象结束\n  缓冲和利用矢量I / O等基础功能。")]),t._v(" "),r("li",[t._v("在“Sink”特征中添加一种新方法“close”，以表达优雅\n  关掉。")])]),t._v(" "),t._m(1),t._v(" "),r("p",[t._v("让我们更深入地了解每个细节的变化，看看现在有什么可用。")]),t._v(" "),t._m(2),t._v(" "),r("p",[t._v("现有的["),r("code",[t._v("tokio_core :: io")]),t._v("]模块提供了许多有用的抽象\n但它们并不是"),r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v("本身所特有的，也不是它的主要目的\n"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v(" crate是提供这些核心实用程序而没有任何含义\n运行时。使用"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v(" crates可以依赖于异步I / O语义\n而不是将自己绑定到特定的运行时，例如"),r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v("。\n"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v(" crate旨在类似于["),r("code",[t._v("std :: io")]),t._v("]标准\n库模块在为异步提供通用抽象方面\n生态系统。 "),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("中提出的概念和特征是基础\n对于在Tokio堆栈中完成的所有I / O.")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("的主要内容是"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/trait.AsyncRead.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("AsyncRead")]),r("OutboundLink")],1),t._v("和"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/trait.AsyncWrite.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("AsyncWrite")]),r("OutboundLink")],1),t._v("\n特征。这两个特征是一种“分裂"),r("a",{attrs:{href:"https://docs.rs/tokio-core/0.1/tokio_core/io/trait.Io.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Io")]),r("OutboundLink")],1),t._v("特征”并被选中\n划分实现类似Tokio的读/写语义的类型（非阻塞\n并通知未来的任务）。然后这些特征与[字节]集成\n箱子提供一些方便的功能，并保留旧的功能，如\n"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/trait.AsyncRead.html#method.split",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("split")]),r("OutboundLink")],1),t._v("。")]),t._v(" "),r("p",[t._v("我们还有机会刷新"),r("a",{attrs:{href:"https://docs.rs/tokio-core/0.1/tokio_core/io/trait.Codec.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Codec")]),r("OutboundLink")],1),t._v("特征\n"),r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v(" crate到"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/codec/trait.Encoder.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Encoder")]),r("OutboundLink")],1),t._v("和"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/codec/trait.Decoder.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Decoder")]),r("OutboundLink")],1),t._v("特征，它们可以运行\n"),r("a",{attrs:{href:"https://crates.io/crates/bytes",target:"_blank",rel:"noopener noreferrer"}},[t._v("bytes"),r("OutboundLink")],1),t._v(" crate中的类型（"),r("a",{attrs:{href:"https://docs.rs/tokio-core/0.1/tokio_core/io/struct.EasyBuf.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("EasyBuf")]),r("OutboundLink")],1),t._v("在"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("中不存在，而且它是\n现在在"),r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v("中弃用了。这些类型允许您快速移动\n字节流到"),r("a",{attrs:{href:"https://docs.rs/futures/0.1/futures/sink/trait.Sink.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Sink")]),r("OutboundLink")],1),t._v("和"),r("a",{attrs:{href:"https://docs.rs/futures/0.1/futures/stream/trait.Stream.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Stream")]),r("OutboundLink")],1),t._v("准备好接受成帧消息。\n一个很好的例子就是使用"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("我们可以使用新的\n"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/codec/length_delimited/index.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("length_delimited")]),r("OutboundLink")],1),t._v("模块结合"),r("a",{attrs:{href:"https://github.com/carllerche/tokio-serde-json",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-serde-json"),r("OutboundLink")],1),t._v("起床和\n我们将在本文后面看到，立即使用JSON RPC服务器运行。")]),t._v(" "),r("p",[t._v("总的来说，"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("我们也能够重新审视几个小问题\nAPI设计。这反过来使我们能够[关闭一大堆\n问题] [关闭]反对"),r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v("。我们觉得"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("是一个很好的补充\n向前移动的Tokio堆栈。板条箱可以选择抽象\n如果他们愿意的话，"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("不会像"),r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v("那样拉动运行时间。")]),t._v(" "),t._m(3),t._v(" "),r("p",[r("a",{attrs:{href:"https://crates.io/crates/tokio-core",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-core"),r("OutboundLink")],1),t._v("的一个长期疣是它的"),r("a",{attrs:{href:"https://docs.rs/tokio-core/0.1/tokio_core/io/struct.EasyBuf.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("EasyBuf")]),r("OutboundLink")],1),t._v("字节缓冲区类型。\n这种类型基本上就是它所说的锡（“简单”缓冲区），但是\n遗憾的是，在高性能用例中通常不是您想要的。我们已经\n长期以来希望有更好的抽象（以及更好的具体实现）\n这里。")]),t._v(" "),r("p",[t._v("使用"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("你会发现"),r("a",{attrs:{href:"https://crates.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("crates.io"),r("OutboundLink")],1),t._v("上的"),r("a",{attrs:{href:"https://crates.io/crates/bytes",target:"_blank",rel:"noopener noreferrer"}},[t._v("bytes"),r("OutboundLink")],1),t._v("箱子更多\n紧密集成并提供高性能所需的抽象\n和“简单”缓冲同时。 "),r("a",{attrs:{href:"https://crates.io/crates/bytes",target:"_blank",rel:"noopener noreferrer"}},[t._v("bytes"),r("OutboundLink")],1),t._v("箱子的主要内容是\n"),r("a",{attrs:{href:"http://carllerche.github.io/bytes/bytes/trait.Buf.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Buf")]),r("OutboundLink")],1),t._v("和"),r("a",{attrs:{href:"http://carllerche.github.io/bytes/bytes/trait.BufMut.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("BufMut")]),r("OutboundLink")],1),t._v("特征。这两个特征充当了能力\n任意字节缓冲区（可读和可写）都是抽象的\n在所有异步I / O对象上集成了"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/trait.AsyncRead.html#method.read_buf",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("read_buf")]),r("OutboundLink")],1),t._v("和"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/trait.AsyncWrite.html#method.write_buf",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("write_buf")]),r("OutboundLink")],1),t._v("\n现在。")]),t._v(" "),r("p",[t._v("除了用于抽象多种缓冲区的特性"),r("a",{attrs:{href:"https://crates.io/crates/bytes",target:"_blank",rel:"noopener noreferrer"}},[t._v("bytes"),r("OutboundLink")],1),t._v(" crate\n有两个高质量的这些特征实现，"),r("a",{attrs:{href:"http://carllerche.github.io/bytes/bytes/struct.Bytes.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Bytes")]),r("OutboundLink")],1),t._v("和\n"),r("a",{attrs:{href:"http://carllerche.github.io/bytes/bytes/struct.BytesMut.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("BytesMut")]),r("OutboundLink")],1),t._v("类型（分别实现"),r("a",{attrs:{href:"http://carllerche.github.io/bytes/bytes/trait.Buf.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Buf")]),r("OutboundLink")],1),t._v("和"),r("a",{attrs:{href:"http://carllerche.github.io/bytes/bytes/trait.BufMut.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("BufMut")]),r("OutboundLink")],1),t._v("特征）。\n简而言之，这些类型代表允许的引用计数缓冲区\n以有效的方式对数据切片进行零拷贝提取。引导他们\n还支持各种常见操作，如微小缓冲区（内联\n存储），单一所有者（可以在内部使用"),r("code",[t._v("Vec")]),t._v("），共享所有者\n不相交的视图（"),r("code",[t._v("BytesMut")]),t._v("），以及可能重叠视图的共享所有者\n（"),r("code",[t._v("Bytes")]),t._v("）。")]),t._v(" "),r("p",[t._v("总的来说，我们希望的[字节]包是你的一站式字节缓冲区\n抽象以及高质量的实现，让您运行\n很快。我们很高兴看到"),r("a",{attrs:{href:"https://crates.io/crates/bytes",target:"_blank",rel:"noopener noreferrer"}},[t._v("bytes"),r("OutboundLink")],1),t._v("箱子里面有什么东西！")]),t._v(" "),t._m(4),t._v(" "),r("p",[t._v("我们最近登陆的最后一个重大变化是增加了一个新的\n关于的方法")]),t._v(" "),t._m(5),t._v(" "),r("p",[t._v("我们最近登陆的最后一个重大变化是增加了一个新的\n"),r("a",{attrs:{href:"https://docs.rs/futures/0.1/futures/sink/trait.Sink.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("Sink")]),r("OutboundLink")],1),t._v("特征的方法，"),r("a",{attrs:{href:"https://docs.rs/futures/0.1/futures/sink/trait.Sink.html#method.close",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("close")]),r("OutboundLink")],1),t._v("。 到目前为止还不是很好\n关于以通用方式实现“优雅关闭”的故事，因为那里\n没有干净的方式向水槽表明没有更多的物品被推入\n它。 新的"),r("a",{attrs:{href:"https://docs.rs/futures/0.1/futures/sink/trait.Sink.html#method.close",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("close")]),r("OutboundLink")],1),t._v("方法正是为此目的而准备的。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://docs.rs/futures/0.1/futures/sink/trait.Sink.html#method.close",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("close")]),r("OutboundLink")],1),t._v("方法允许通知接收器不再有消息\n推进去了。 然后，接收器可以借此机会刷新消息\n否则执行协议特定的关闭。 例如，TLS连接\n该点可能会启动关闭操作或代理连接\n发出TCP级别的关闭。 通常情况下，这最终会触底到新的\n["),r("code",[t._v("AsyncWrite :: shutdown")]),t._v("]方法。")]),t._v(" "),t._m(6),t._v(" "),r("p",[t._v("使用"),r("a",{attrs:{href:"https://crates.io/crates/tokio-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-io"),r("OutboundLink")],1),t._v("登陆的一个大功能是添加\n"),r("a",{attrs:{href:"https://docs.rs/tokio-io/0.1/tokio_io/codec/length_delimited/index.html",target:"_blank",rel:"noopener noreferrer"}},[r("code",[t._v("length_delimited")]),r("OutboundLink")],1),t._v("模块（受Netty的启发\n["),r("code",[t._v("LengthFieldBasedFrameDecoder")]),t._v("]）。 许多协议使用a来分隔帧\n包含帧长度的帧头。 举一个简单的例子，拿一个\n使用"),r("code",[t._v("u32")]),t._v("的帧头来划分帧有效载荷的协议。 每\n电线上的框架看起来像这样：")]),t._v(" "),t._m(7),r("p",[t._v("解析此协议可以轻松处理")]),t._v(" "),t._m(8),r("p",[t._v("在上面的例子中，"),r("code",[t._v("transport")]),t._v("将是缓冲区的"),r("code",[t._v("Sink + Stream")]),t._v("\n值，其中每个缓冲区包含帧有效负载。 这使得\n将帧编码和解码为相当容易的值\n像[serde]这样的东西。 例如，使用"),r("a",{attrs:{href:"https://github.com/carllerche/tokio-serde-json",target:"_blank",rel:"noopener noreferrer"}},[t._v("tokio-serde-json"),r("OutboundLink")],1),t._v("，我们可以\n快速实现基于JSON的协议，其中每个帧都是长度\n分隔，并使用JSON编码帧有效负载：")]),t._v(" "),t._m(9),r("p",[t._v("完整的例子就在"),r("a",{attrs:{href:"https://github.com/carllerche/tokio-serde-json/tree/master/examples",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),r("OutboundLink")],1),t._v("。")]),t._v(" "),r("p",[t._v("length_delimited模块包含足够的配置设置来处理具有更复杂帧头的解析长度分隔帧，如HTTP / 2.0协议。")]),t._v(" "),t._m(10),t._v(" "),r("p",[t._v("所有这些变化汇集在一起​​，关闭了期货和托克欧核心板条箱中的大量问题，我们认为Tokio正是我们喜欢的常见I / O和缓冲抽象的位置。一如既往，我们很乐意听到有关问题跟踪器的反馈，如果您发现问题，我们非常愿意合并PR！否则我们期待在实践中看到所有这些变化！")]),t._v(" "),r("p",[t._v("凭借tokio-core，tokio-io，tokio-service和tokio-proto的基础，Tokio团队期待着适应和实施更加雄心勃勃的协议，如HTTP / 2。我们正在与@seanmonstar和Hyper密切合作，以开发这些基础HTTP库。最后，我们希望在不久的将来扩展与HTTP和通用tokio服务实现相关的中间件故事。更多关于这个即将到来！")])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"宣布tokio-io-crate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#宣布tokio-io-crate","aria-hidden":"true"}},[this._v("#")]),this._v(" 宣布tokio-io Crate")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("这些更改改进了Tokio的组织和抽象\n几个长期存在的问题，应该为所有人提供稳定的基础\n未来的发展。与此同时，这些变化并没有破坏\n旧的"),e("code",[this._v("io")]),this._v("模块仍然以不推荐的形式提供。你可以开始全部使用了\n这些箱子立即通过"),e("code",[this._v("cargo update")]),this._v("并使用最新的"),e("code",[this._v("0.1。*")]),this._v("\n板条箱的版本！")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"添加一个tokio-io箱子"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加一个tokio-io箱子","aria-hidden":"true"}},[this._v("#")]),this._v(" 添加一个"),e("code",[this._v("tokio-io")]),this._v("箱子")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"集成bytes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#集成bytes","aria-hidden":"true"}},[this._v("#")]),this._v(" 集成"),e("code",[this._v("bytes")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"添加sink-close"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加sink-close","aria-hidden":"true"}},[this._v("#")]),this._v(" 添加"),e("code",[this._v("Sink :: close")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"添加-sink-close"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加-sink-close","aria-hidden":"true"}},[this._v("#")]),this._v(" 添加 "),e("code",[this._v("Sink::close")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"添加-codec-length-delimited"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加-codec-length-delimited","aria-hidden":"true"}},[this._v("#")]),this._v(" 添加 "),e("code",[this._v("codec::length_delimited")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-text extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("+----------+--------------------------------+\n| len: u32 |          frame payload         |\n+----------+--------------------------------+\n")])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"language-rust extra-class"},[r("pre",{pre:!0,attrs:{class:"language-rust"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Bind a server socket")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" socket "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TcpStream"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1:17653"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("unwrap")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("handle"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nsocket"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("and_then")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token closure-params"}},[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("socket"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")])]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Delimit frames using a length header")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" transport "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" length_delimited"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),t._v("FramedWrite"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("new")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("socket"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"language-rust extra-class"},[r("pre",{pre:!0,attrs:{class:"language-rust"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Bind a server socket")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" socket "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TcpStream"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1:17653"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("unwrap")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("handle"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nsocket"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("and_then")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token closure-params"}},[r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("socket"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")])]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Delimit frames using a length header")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" transport "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" length_delimited"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),t._v("FramedWrite"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("new")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("socket"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Serialize frames with JSON")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" serialized "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WriteJson"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("new")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("transport"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),r("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Send the value")]),t._v("\n    serialized"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("json!")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"John Doe"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"age"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("43")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"phones"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+44 1234567"')]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"+44 2345678"')]),t._v("\n        "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"下一步是什么？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下一步是什么？","aria-hidden":"true"}},[this._v("#")]),this._v(" 下一步是什么？")])}],!1,null,null,null);e.default=o.exports}}]);